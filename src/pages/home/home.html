<ion-header>
  <ion-navbar>
    <div *ngIf="!communication.tabsControllButton">
      <ion-title text-center *ngIf="!showSearchbar">Пропозиції
        <div class="icon-right">
          <ion-icon ios="ios-search" md="md-search" (click)="showSBar()"></ion-icon>
        </div>
      </ion-title>
      <div *ngIf="showSearchbar">
        <ion-searchbar
          [animated]="'true'"
          [showCancelButton]="'true'"
          (ionCancel)="hideSBar()">
        </ion-searchbar>
      </div>
    </div>
    <ion-row justify-content-between align-items-center *ngIf="communication.tabsControllButton">
      <ion-col>
        <button color="white"
                ion-button clear
                text-capitalize
                no-margin
                no-padding
                (click)="goToFriendsSelection()">
          Назад
        </button>
      </ion-col>
      <ion-title text-center>
        Поделиться предложением
      </ion-title>
      <ion-col text-end no-padding>
        <button color="white"
                text-capitalize
                ion-button clear
                no-margin
                no-padding
                (click)="checkAll ()">
          Все
        </button>
      </ion-col>
    </ion-row>
  </ion-navbar>
</ion-header>

<ion-content padding-vertical>
  <div class="fix_buttons">
    <ion-grid>
      <ion-row>
        <ion-col col-6>
          <ion-segment [(ngModel)]="sentence">
            <ion-segment-button class="left_button" value="all"
                                (click)="( communication.tabsControllButton ? '' : loadJobs ())">
              <p>Всі</p>
            </ion-segment-button>
            <ion-segment-button class="right_button" value="my"
                                (click)="( communication.tabsControllButton ? '' : getMyJobs())">
              <p>Мої</p>
            </ion-segment-button>
          </ion-segment>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <div [ngSwitch]="sentence">
    <ion-list *ngSwitchCase="'my'">
      <job-card *ngFor=" let job of myJobsArr; index as i;"
                [job]="job"
                [jobsArr]="myJobsArr"></job-card>

      <!--todo refactoring-->
      <!--<hr>-->
      <!--<ion-card *ngFor=" let job of myJobsArr; index as i;">-->
      <!--&lt;!&ndash;<div *ngIf="i<scrollLimit">&ndash;&gt;-->
      <!--<div (click)="showMyJobDetails(job)">-->
      <!--<ion-card-content text-wrap>-->
      <!--<h2> {{job.job.title}}-->
      <!--<p>-->
      <!--<wbr>-->
      <!--<i>{{job.status}}</i></p>-->
      <!--</h2>-->
      <!--<div class="data">-->
      <!--<fa-icon name="building"></fa-icon>-->
      <!--<wbr>&nbsp;{{job.job.employer }}-->
      <!--<br>-->
      <!--<fa-icon name="calendar"></fa-icon>&nbsp; {{job.job.start_date | date:"dd.MM.yy"}} - -->
      <!--{{job.job.end_date | date:"dd.MM.yy"}}-->
      <!--<span><br><fa-icon name="money"></fa-icon>&nbsp; {{job.job.price }}$-->
      <!--&nbsp;<fa-icon name="map-marker"></fa-icon> &nbsp;{{job.job.city}}</span>-->
      <!--</div>-->
      <!--<div *ngIf="job.details">-->
      <!--<p margin-vertical>{{job.description}}</p>-->
      <!--<div col-xs-auto>-->
      <!--<div class="checks">-->
      <!--<h4>Проживання-->
      <!--<fa-icon name="{{job.job.food ? 'check' : 'times'}}" icon-end></fa-icon>-->
      <!--</h4>-->
      <!--<h4>Харчування&nbsp;<fa-icon name="{{job.job.residence ? 'check' : 'times'}}" icon-end></fa-icon>-->
      <!--</h4>-->
      <!--<h4>Перевезення&nbsp;<fa-icon name="{{job.job.transportation ? 'check' : 'times'}}"-->
      <!--icon-end></fa-icon>-->
      <!--</h4>-->
      <!--</div>-->
      <!--</div>-->
      <!--</div>-->
      <!--</ion-card-content>-->
      <!--<ion-row>-->
      <!--<ion-col left text-left>-->
      <!--<ion-note>-->
      <!--Розміщено <span *ngIf="!job.createdRecently">{{job.created_at | date:"dd.MM.yy"}}</span>-->
      <!--<span *ngIf="job.createdRecently">{{job.createdRecently}}</span> · &nbsp; перегляди: {{job.job.count}}-->
      <!--<ion-checkbox color="pimary"-->
      <!--*ngIf="communication.tabsControllButton"-->
      <!--[checked]="job.checked"-->
      <!--(click)="checkJob(job)"-->
      <!--item-end></ion-checkbox>-->
      <!--</ion-note>-->
      <!--</ion-col>-->
      <!--</ion-row>-->
      <!--</div>-->
      <!--<div row col-12 *ngIf="!communication.tabsControllButton">-->
      <!--<button ion-button round outline id="left_button" (click)="shareJob(job)">Поділитися</button>-->
      <!--<button ion-button round outline id="disable_button" (click)="escapeJob(job)">Відхилити заявку</button>-->
      <!--</div>-->
      <!--&lt;!&ndash;</div>&ndash;&gt;-->
      <!--</ion-card>-->
      <div class="message" *ngIf="!myJobsArr || myJobsArr.length === 0">
        <h6>Ви не подали ще жодної заявки на роботу</h6>
      </div>
    </ion-list>

    <ion-list *ngSwitchCase="'all'">

      <job-card *ngFor=" let job of suggestedJobs; index as i;"
      [job]="job"
      [jobsArr]="suggestedJobs"></job-card>

      <!--<ion-card *ngFor="let suggestedJob of suggestedJobs">-->
        <!--<ion-item text-wrap>-->
          <!--<ion-avatar item-start>-->
            <!--<img *ngIf="suggestedJob.photo_path" [src]="suggestedJob.photo_path">-->
            <!--<div *ngIf="!suggestedJob.photo_path" class="photo-placeholder" text-center>-->
          <!--<span>-->
            <!--{{(suggestedJob.first_name ? suggestedJob.first_name[0] : '') + (suggestedJob.last_name ? suggestedJob.last_name[0] : '')}}-->
          <!--</span>-->
            <!--</div>-->
          <!--</ion-avatar>-->
          <!--<h3><b>{{suggestedJob.first_name + ' ' + suggestedJob.last_name}}</b>-->
            <!--<i>прислав Вам заявку на роботу</i></h3>-->
        <!--</ion-item>-->

        <!--<ion-card-content text-wrap (click)="showDetails(suggestedJob.job)">-->
          <!--<h2> {{suggestedJob.job.title}}</h2>-->
          <!--<div class="data">-->
            <!--<fa-icon name="building"></fa-icon>-->
            <!--<wbr>&nbsp;{{suggestedJob.job.employer }}-->
            <!--<br>-->
            <!--<fa-icon name="calendar"></fa-icon>&nbsp; {{suggestedJob.job.start_date | date:"dd.MM.yy"}} - -->
            <!--{{suggestedJob.job.end_date | date:"dd.MM.yy"}}-->
            <!--<span><br><fa-icon name="money"></fa-icon>&nbsp; {{suggestedJob.job.price }}$-->
                            <!--&nbsp;<fa-icon name="map-marker"></fa-icon> &nbsp;{{suggestedJob.job.city}}</span>-->
          <!--</div>-->
          <!--<div *ngIf="suggestedJob.job.details">-->
            <!--<p margin-vertical>{{suggestedJob.job.description}}</p>-->
            <!--<div col-xs-auto>-->
              <!--<div class="checks">-->
                <!--<h4>Проживання-->
                  <!--<fa-icon name="{{suggestedJob.job.food ? 'check' : 'times'}}" icon-end></fa-icon>-->
                <!--</h4>-->
                <!--<h4>Харчування&nbsp;<fa-icon name="{{suggestedJob.job.residence ? 'check' : 'times'}}"-->
                                             <!--icon-end></fa-icon>-->
                <!--</h4>-->
                <!--<h4>Перевезення&nbsp;&nbsp;<fa-icon name="{{suggestedJob.job.transportation ? 'check' : 'times'}}"-->
                                                    <!--icon-end></fa-icon>-->
                <!--</h4>-->
              <!--</div>-->
            <!--</div>-->
          <!--</div>-->
        <!--</ion-card-content>-->
        <!--<ion-row>-->
          <!--<ion-col left text-left>-->
            <!--<ion-note>-->
              <!--Розміщено <span *ngIf="!suggestedJob.job.createdRecently">{{suggestedJob.job.created_at | date:"dd.MM.yy"}}</span>-->
              <!--<span *ngIf="suggestedJob.job.createdRecently">{{suggestedJob.job.createdRecently}}</span> · &nbsp;-->
              <!--перегляди: {{suggestedJob.job.count}}-->
              <!--<ion-checkbox color="pimary"-->
                            <!--*ngIf="communication.tabsControllButton"-->
                            <!--[checked]="suggestedJob.job.checked"-->
                            <!--(click)="checkJob(suggestedJob.job)"-->
                            <!--item-end></ion-checkbox>-->
            <!--</ion-note>-->
          <!--</ion-col>-->
        <!--</ion-row>-->
        <!--<div row col-12 *ngIf="!communication.tabsControllButton">-->
          <!--<button ion-button round outline id="left_button" (click)="shareJob(suggestedJob.job)">Поділитися</button>-->
          <!--<button ion-button round outline id="orange_button" (click)="toMyJobs(suggestedJob.job)">Подати заявку-->
          <!--</button>-->
        <!--</div>-->
      <!--</ion-card>-->

      <!--todo remake it if doesnt work-->

      <job-card *ngFor=" let job of jobsArr; index as i;"
                [job]="job"
                [jobsArr]="jobsArr"></job-card>

      <!--<ion-card *ngFor=" let job of jobsArr; index as i;">-->
      <!--<div *ngIf="i<scrollLimit">-->
      <!--<ion-card-content text-wrap (click)="showDetails(job)">-->
      <!--<h2> {{job.title}}</h2>-->
      <!--<div class="data">-->
      <!--<fa-icon name="building"></fa-icon>-->
      <!--<wbr>&nbsp;{{job.employer }}-->
      <!--<br>-->
      <!--<fa-icon name="calendar"></fa-icon>&nbsp; {{job.start_date | date:"dd.MM.yy"}} - -->
      <!--{{job.end_date | date:"dd.MM.yy"}}-->
      <!--<span><br><fa-icon name="money"></fa-icon>&nbsp; {{job.price }}$-->
      <!--&nbsp;<fa-icon name="map-marker"></fa-icon> &nbsp;{{job.city}}</span>-->
      <!--</div>-->
      <!--<div *ngIf="job.details">-->
      <!--<p margin-vertical>{{job.description}}</p>-->
      <!--<div col-xs-auto>-->
      <!--<div class="checks">-->
      <!--<h4>Проживання-->
      <!--<fa-icon name="{{job.food ? 'check' : 'times'}}" icon-end></fa-icon>-->
      <!--</h4>-->
      <!--<h4>Харчування&nbsp;<fa-icon name="{{job.residence ? 'check' : 'times'}}" icon-end></fa-icon>-->
      <!--</h4>-->
      <!--<h4>Перевезення&nbsp;&nbsp;<fa-icon name="{{job.transportation ? 'check' : 'times'}}"-->
      <!--icon-end></fa-icon>-->
      <!--</h4>-->
      <!--</div>-->
      <!--</div>-->
      <!--</div>-->
      <!--</ion-card-content>-->
      <!--<ion-row>-->
      <!--<ion-col left text-left>-->
      <!--<ion-note>-->
      <!--Розміщено <span *ngIf="!job.createdRecently">{{job.created_at | date:"dd.MM.yy"}}</span>-->
      <!--<span *ngIf="job.createdRecently">{{job.createdRecently}}</span> · &nbsp; перегляди: {{job.count}}-->
      <!--<ion-checkbox color="pimary"-->
      <!--*ngIf="communication.tabsControllButton"-->
      <!--[checked]="job.checked"-->
      <!--(click)="checkJob(job)"-->
      <!--item-end></ion-checkbox>-->
      <!--</ion-note>-->
      <!--</ion-col>-->
      <!--</ion-row>-->
      <!--<div row col-12 *ngIf="!communication.tabsControllButton">-->
      <!--<button ion-button round outline id="left_button" (click)="shareJob(job)">Поділитися</button>-->
      <!--<button ion-button round outline id="orange_button" (click)="toMyJobs(job)">Подати заявку</button>-->
      <!--</div>-->
      <!--</div>-->
      <!--</ion-card>-->
      <div class="message" *ngIf="!jobsArr || jobsArr.length === 0">
        <h6>У Вас немає активних пропозицій</h6>
      </div>
    </ion-list>
  </div>

  <ion-infinite-scroll (ionInfinite)="doInfinite($event)" *ngIf="this.scrollLimit < this.jobsArr.length">
    <ion-infinite-scroll-content
      loadingSpinner="bubbles"
      loadingText="Loading more data...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll>

</ion-content>

